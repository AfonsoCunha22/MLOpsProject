# Machine Learning Operations - Song Lyrics Sentiment Analysis
## **Description**
The goal of this project is to perform **sentiment analysis** on **English song lyrics**, filtering out non-English lyrics from the dataset. Sentiment analysis provides insights into the emotional tone of song lyrics, classifying sentiments into five categories: Very Negative, Negative, Neutral, Positive, and Very Positive.

We leverage **Hugging Face** and pre-trained language models for sentiment classification. By employing state-of-the-art tools and best practices in MLOps, we aim to create a scalable and reproducible pipeline for analyzing large datasets of song lyrics.

This project incorporates multiple components of MLOps, including **data versioning**, **experiment tracking**, **pipeline reproducibility**, and **containerization**, ensuring a streamlined and efficient workflow.


## **Frameworks and Tools**
To achieve the project's objectives, we use the following tools and frameworks:

- **Hugging Face**: For building the baseline and utilizing pre-trained sentiment analysis models.
- **DVC (Data Version Control)**: For managing dataset versioning and ensuring data consistency across team members.
- **Weights & Biases (W&B)**: To track experiments, monitor performance metrics, and visualize model training.
- **Hydra**: For configuration management to ensure reproducibility of experiments.
- **Docker**: To containerize the entire pipeline, facilitating portability and deployment across different environments.


## **Dataset**
The dataset used for this project includes song lyrics scraped from **Genius**, a platform where users can upload and annotate lyrics. The dataset, which includes songs as recent as 2022, is based on the **5 Million Song Lyrics Dataset** and has been augmented with language identification information using pre-trained models.

For this project, we filter the dataset to include **only English song lyrics**, as they form the focus of our sentiment analysis. The processed dataset can be found on Kaggle: [Genius Song Lyrics with Language Information](https://www.kaggle.com/datasets/carlosgdcj/genius-song-lyrics-with-language-information).


## **Model**
The sentiment analysis is conducted using the **tabularisai/multilingual-sentiment-analysis** model, a fine-tuned version of **distilbert-base-multilingual-cased**. Key features of the model:

- It is fine-tuned for **multilingual sentiment analysis**.
- Trained exclusively on **synthetic multilingual data** generated by advanced large language models (LLMs).
- The model achieves robust performance across various languages and cultural contexts.
- It classifies sentiment into five categories: **Very Negative**, **Negative**, **Neutral**, **Positive**, and **Very Positive**.

By using synthetic data, the model ensures a broad coverage of sentiment expressions while reducing bias, making it suitable for tasks involving diverse datasets. The reference model can be found on Hugging Face: [Multilingual Sentiment Analysis](https://huggingface.co/tabularisai/multilingual-sentiment-analysis)

---

This project was completed as part of the Machine Learning Operations (MLOps) course 02476 at DTU. The group consists of **Afonso Cunha**, **Lydia Kasapi**, **Sabina Kozlowska**, and **Sandra Gomez**.


## Project structure

The directory structure of the project looks like this:
```txt
├── .github/                  # Github actions and dependabot
│   ├── dependabot.yaml
│   └── workflows/
│       └── tests.yaml
├── configs/                  # Configuration files
├── data/                     # Data directory
│   ├── processed
│   └── raw
├── dockerfiles/              # Dockerfiles
│   ├── api.Dockerfile
│   └── train.Dockerfile
├── docs/                     # Documentation
│   ├── mkdocs.yml
│   └── source/
│       └── index.md
├── models/                   # Trained models
├── notebooks/                # Jupyter notebooks
├── reports/                  # Reports
│   └── figures/
├── src/                      # Source code
│   ├── project_name/
│   │   ├── __init__.py
│   │   ├── api.py
│   │   ├── data.py
│   │   ├── evaluate.py
│   │   ├── models.py
│   │   ├── train.py
│   │   └── visualize.py
└── tests/                    # Tests
│   ├── __init__.py
│   ├── test_api.py
│   ├── test_data.py
│   └── test_model.py
├── .gitignore
├── .pre-commit-config.yaml
├── LICENSE
├── pyproject.toml            # Python project file
├── README.md                 # Project README
├── requirements.txt          # Project requirements
├── requirements_dev.txt      # Development requirements
└── tasks.py                  # Project tasks
```


Created using [mlops_template](https://github.com/SkafteNicki/mlops_template),
a [cookiecutter template](https://github.com/cookiecutter/cookiecutter) for getting
started with Machine Learning Operations (MLOps).
